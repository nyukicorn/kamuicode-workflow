name: Creative Test Lab

on:
  workflow_dispatch:
    inputs:
      experiment_description:
        description: 'ãƒ†ã‚¹ãƒˆã—ãŸã„å®Ÿé¨“å†…å®¹'
        required: true
        type: string
      
      mcp_to_test:
        description: 'ãƒ†ã‚¹ãƒˆã™ã‚‹MCP'
        required: false
        type: string
        default: 'imagen4-fast'

jobs:
  test-experiment:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Setup environment
        run: |
          echo "ðŸ§ª å®Ÿé¨“é–‹å§‹"
          echo "å®Ÿé¨“å†…å®¹: ${{ inputs.experiment_description }}"
          echo "ä½¿ç”¨MCP: ${{ inputs.mcp_to_test }}"
          
          # å®Ÿé¨“ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
          EXPERIMENT_ID="exp-$(date +%Y%m%d-%H%M%S)"
          mkdir -p "experiment-results/$EXPERIMENT_ID"
          
          echo "å®Ÿé¨“ID: $EXPERIMENT_ID"
          echo "EXPERIMENT_ID=$EXPERIMENT_ID" >> $GITHUB_ENV
      
      - name: Simple test execution
        run: |
          echo "ðŸ”§ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­..."
          
          # ç°¡å˜ãªãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
          cat > "experiment-results/$EXPERIMENT_ID/test-result.txt" << EOF
          å®Ÿé¨“çµæžœãƒ¬ãƒãƒ¼ãƒˆ
          
          å®Ÿé¨“ID: $EXPERIMENT_ID
          å®Ÿé¨“å†…å®¹: ${{ inputs.experiment_description }}
          ä½¿ç”¨MCP: ${{ inputs.mcp_to_test }}
          å®Ÿè¡Œæ™‚åˆ»: $(date)
          
          ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ãƒ†ã‚¹ãƒˆå®Œäº†
          EOF
          
          echo "âœ… ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå®Œäº†"
      
      - name: Commit results
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          
          git add experiment-results/
          
          if git diff --cached --quiet; then
            echo "å¤‰æ›´ãªã—"
          else
            git commit -m "Test experiment: $EXPERIMENT_ID"
            git push
          fi
          
          echo "ðŸŽ‰ å®Ÿé¨“å®Œäº†: $EXPERIMENT_ID"