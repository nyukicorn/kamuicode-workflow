name: 'Setup Branch for Project'
description: 'Create a new branch and folder structure for project generation'
author: 'KamuiCode Workflow'

inputs:
  project-prefix:
    description: 'The project prefix for branch and folder naming (e.g., music-video, threejs-experience)'
    required: false
    default: 'music-video'

outputs:
  branch-name:
    description: 'The name of the created branch'
    value: ${{ steps.create-branch.outputs.branch-name }}
  folder-name:
    description: 'The name of the created folder'
    value: ${{ steps.create-branch.outputs.folder-name }}

runs:
  using: 'composite'
  steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Create branch for project generation
      id: create-branch
      shell: bash
      run: |
        PROJECT_PREFIX="${{ inputs.project-prefix }}"
        BRANCH_NAME="$PROJECT_PREFIX/$(date +%Y%m%d)-${{ github.run_id }}"
        FOLDER_NAME="$PROJECT_PREFIX-$(date +%Y%m%d)-${{ github.run_id }}"
        git checkout -b $BRANCH_NAME
        git config user.name "github-actions[bot]"
        git config user.email "github-actions[bot]@users.noreply.github.com"
        git push origin $BRANCH_NAME
        echo "branch-name=$BRANCH_NAME" >> $GITHUB_OUTPUT
        echo "folder-name=$FOLDER_NAME" >> $GITHUB_OUTPUT
        echo "Created branch: $BRANCH_NAME"
        echo "Folder name: $FOLDER_NAME"