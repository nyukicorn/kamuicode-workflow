# 桜舞う京都の夜 - Three.js Experience

## 🌸 体験コンセプト

**桜舞う京都の夜、パーティクルは花びらのように舞い踊る**

幻想的な京都の夜景をパノラマ背景に、桜の花びらをモチーフにしたハート型パーティクルが3D空間で美しく舞い踊るインタラクティブな体験です。日本の美しい季節感と現代的なWeb技術を融合させた作品です。

## ✨ 主な機能

- 🌸 **3Dパノラマ環境**: 京都の夜景を360度パノラマで体験
- 💖 **ハート型パーティクル**: 3000個の桜の花びらが3D空間で舞い踊る
- 🎨 **カラーカスタマイズ**: 単色、グラデーション、レインボーの色彩設定
- 🎵 **BGM統合**: 雰囲気を高める音楽のオン/オフ制御
- 📱 **レスポンシブ対応**: PC・タブレット・スマートフォンに対応
- 🎯 **直感的操作**: マウス・タッチによる滑らかな視点操作

## 🎮 操作方法

### マウス操作（PC）
- **ドラッグ**: 視点移動（360度回転）
- **ホイール**: ズーム イン/アウト
- **ダブルクリック**: 自動回転のオン/オフ切り替え

### タッチ操作（モバイル）
- **スワイプ**: 視点移動
- **ピンチ**: ズーム操作
- **ダブルタップ**: 自動回転のオン/オフ切り替え

### UI コントロール
- **色モード選択**: 単色・グラデーション・レインボー
- **ベース色設定**: カラーピッカーによる色調整
- **音楽制御**: BGMの再生/停止ボタン

## 🛠 技術仕様

### 必要環境
- **WebGL対応ブラウザ** (Chrome 9+, Firefox 4+, Safari 5.1+, Edge)
- **JavaScript有効化**
- **オーディオ再生対応**

### 使用技術
- **Three.js r128**: 3Dグラフィックス・WebGLレンダリング
- **JavaScript ES6+**: モダンなWebプログラミング
- **HTML5 Canvas**: 高性能な描画処理
- **Web Audio API**: 音楽再生とユーザーインタラクション

### パフォーマンス最適化
- **3000パーティクル**: 滑らかな60FPS動作を目標
- **テクスチャ最適化**: パノラマ画像サイズ 1.7MB
- **音楽ファイル**: 高品質WAV形式 6.1MB
- **レスポンシブレンダリング**: デバイス解像度に自動対応

## 🚀 ローカル実行方法

### 1. ファイルの配置
```
threejs-experience-20250719-16393629856/
├── src/
│   ├── index.html          # メインファイル
│   ├── panorama.jpg        # パノラマ背景画像
│   └── generated-music.wav # BGM音楽ファイル
└── README.md              # このファイル
```

### 2. ローカルサーバーの起動

**Python 3使用**
```bash
cd src
python -m http.server 8000
```

**Node.js使用**
```bash
cd src
npx http-server -p 8000
```

**PHP使用**
```bash
cd src
php -S localhost:8000
```

### 3. ブラウザでアクセス
```
http://localhost:8000
```

## 🌐 対応ブラウザ

### 推奨ブラウザ
- **Chrome 80+** ✅ (最適化済み)
- **Firefox 75+** ✅ (完全対応)
- **Safari 13+** ✅ (macOS/iOS対応)
- **Edge 80+** ✅ (Windows対応)

### モバイル対応
- **iOS Safari 13+** ✅
- **Android Chrome 80+** ✅
- **Samsung Internet 12+** ✅

## 🔧 トラブルシューティング

### よくある問題と解決方法

**1. 画面が真っ黒になる**
- WebGLが無効になっている可能性があります
- ブラウザ設定でハードウェアアクセラレーションを有効にしてください
- 最新ブラウザバージョンに更新してください

**2. パノラマ画像が表示されない**
- ローカルサーバーを使用してアクセスしているか確認
- panorama.jpgファイルが正しい場所に配置されているか確認
- ネットワーク接続を確認してください

**3. 音楽が再生されない**
- ブラウザの自動再生ポリシーにより、ユーザーインタラクションが必要です
- 🎵ボタンをクリックして手動で再生してください
- generated-music.wavファイルの存在を確認してください

**4. 動作が重い・カクつく**
- WebGL対応の確認: about:gpu (Chrome), about:support (Firefox)
- 他のタブやアプリケーションを閉じてメモリを解放
- ブラウザの再起動を試してください

**5. モバイルで操作できない**
- タッチイベントが正しく登録されているか確認
- ブラウザのズーム機能と競合する場合は、メタタグの設定を確認

## 📊 パフォーマンス指標

### 最適化目標
- **フレームレート**: 60FPS維持
- **初期読み込み**: 3秒以内
- **メモリ使用量**: 100MB以下
- **CPU使用率**: 30%以下

### リソースサイズ
- **パノラマ画像**: 1.7MB (最適化済み)
- **音楽ファイル**: 6.1MB (高品質)
- **総ダウンロードサイズ**: 約8MB

## 📱 モバイル最適化

### タッチ操作の特徴
- **シングルタッチ**: 視点移動
- **マルチタッチ**: 将来的な拡張対応
- **ジェスチャー認識**: スムーズなナビゲーション

### レスポンシブデザイン
- **画面サイズ自動調整**
- **解像度最適化**
- **バッテリー消費への配慮**

## 🔒 セキュリティ

### 実装されたベストプラクティス
- **CORS対応**: 適切なリソース読み込み
- **XSS防止**: HTML/JSエスケープ処理
- **リソース検証**: ファイル存在チェック
- **エラーハンドリング**: 適切な例外処理

### 推奨事項
- **HTTPS使用**: プロダクション環境では必須
- **CSP設定**: コンテンツセキュリティポリシーの実装
- **ファイル権限**: 適切なアクセス権限設定

## 🎨 カスタマイズ

### 色彩設定
```javascript
// 基本色の変更
baseColor: "#FFB6C1" // デフォルト: ライトピンク

// カラーモード
- single: 単色表示
- gradient: 同系色グラデーション
- rainbow: レインボー効果
```

### パーティクル調整
```javascript
particleCount: 3000        // パーティクル数
rotationSpeed: 0.02        // 回転速度
floatSpeed: 0.005         // 浮遊速度
```

## 📄 ライセンス

このプロジェクトは教育・個人利用目的で作成されています。
商用利用の場合は、使用素材のライセンスを個別に確認してください。

## 🤝 コントリビューション

改善提案やバグ報告は歓迎いたします。
- パフォーマンス最適化
- 新機能追加
- ブラウザ互換性改善
- ドキュメント改善

---

**🌸 桜舞う京都の夜をお楽しみください 🌸**